apiVersion: v1
kind: Service
metadata:
  name: validate-env-service
  labels:
    app: validate-env
spec:
  ports:
  - port: 8443
    targetPort: 8443
  selector:
    app: validate-env
---
apiVersion: admissionregistration.k8s.io/v1
kind: ValidatingWebhookConfiguration
metadata:
  creationTimestamp: null
  name: validate-env-configuration
  annotations:
    cert-manager.io/inject-ca-from: default/selfsigned-cert
webhooks:
- clientConfig:
    caBundle: Cg==
    service:
      name: validate-env-service  
      path: /environment/validate
      port: 8443
      namespace: "default"
  sideEffects: None
  admissionReviewVersions: ["v1"]
  failurePolicy: Fail
  name: val-env.fission.io
  rules:
      - apiGroups:
        - fission.io
        apiVersions:
        - v1
        operations:
        - CREATE
        - UPDATE
        resources:
        - environments